<?php
class ControllerQuarkQuark extends Controller {
	public function index() {
		
	}

	public function GetAccessToken() 
	{
		$api_url = 'http://dpapi.quarkscm.com/v1/customer/login';
		$post_data = [
			'email'     => 'globalpacts@gmail.com',
			'password'  => 'Godisgreat96!'
		];
		$return_data = $this->getCurlDataToken($api_url,'post',$post_data,100);
		
		//echo '<pre>';
		//print_r($return_data);die;
		
		$result = (array)json_decode($return_data);
		$token = $result['access-token'];
	return $token;
	}

	public function GetCategoryList()
	{
		$this->load->model('quark/quark');
		$token = $this->getAccessToken();
		$url = 'http://dpapi.quarkscm.com/v1/catalog/download';
		$data['access-token'] = $token;
		$res = $this->getCurlData($url,'post',$data);
		$response = json_decode($res);
		$this->model_quark_quark->insertCategoryList($response);
		
	}
	
	public function DownloadProductInfo()
	{
		$this->load->model('quark/quark');
		$token = $this->getAccessToken();
		$url = 'http://dpapi.quarkscm.com/v1/myproduct/download/en_US';
		$data['access-token'] = $token;
		$goods = $this->model_quark_quark->getProductSpus();
		$i=0;
		$goodsSN = array();
		foreach($goods as $key=>$goods)
		{	
			$goodsSN[$i] = $goods['spus'];
			$i++;
		}
		$array_sn = array_chunk($goodsSN,50);
		foreach($array_sn as $sn){
			$data_goods = implode(",",$sn);
			$data['spus'] = ["J2825"];//explode(",",$data_goods);//["D2","H18820"];
			$data['warehouse'] = 'CN';
			$res = $this->getCurlData($url,'post',$data);
			$response = json_decode($res);
			$this->model_quark_quark->insertProductList($response); 
		}
	}
	
	public function DownloadProductInfoUpdate()
	{
		$this->load->model('quark/quark');
		$token = $this->getAccessToken();
		$url = 'http://dpapi.quarkscm.com/v1/myproduct/download/en_US';
		$data['access-token'] = $token;
		$goods = array("X17-2,X17-1,T2051-2,T2051-1,T2051-5,T2051-4,T1411-3,T1411-2,T1411-1,RM7953-1-B,RM7953B,PAV0033S,PAV0033B,PA4108PU,PA4108GY,PA4108B,PA3586UK,PA3094W,PA3094B,D5425-8,D5425-7,D5425-1,D5425-2,D5425-3,D5425-4,D5425-5,D5425-6,D5424PU,D5424BL,D5424C,D5424GR,D5424R,D5424W,D5424Y,T2256-1,T2256-2,T1855-1,T1855-2,T1855-3,T1855-4,PA4215R,PA4215C,PA4215Y,PA4215LPU,PA4215GR,PA4215DPU,PA4215P,PA4215BL,PA3153UK,P1567B-EU,P1537B-EU,OS0652-2,OS0652-1,F1301W,C3410GR,C3410B,T1387-25,T1387-24,T1387-22,T1387-18,T1387-16,T1387-15,T1387-14,T1387-13,T1387-23,T1387-19,T1387-8,T1387-20,T1387-12,T1387-5,T1387-6,T1387-10,T1387-9,T1387-4,T1387-7,T1387-11,T1055-6,T1055-5,T1055-4,T1055-3,T1055-2,T1055-1,PAA0184B,PAA0184W,PA4350B,PA4350BL,PA4350P,PA4350W,OS1321B,OS1321BL,OS1321GR,OS1321R,OS1321W,I1161-4,I1161-3,I1161-2,I1161-1,D5071B,D4640Y,D4640W,D4640S,D4640BL,D4640B,D2204W,D2204B,D2204GR,T1290R,T1290B,T1123-1,RM8616S-1,RM8616B-1,RM8616S,RM8616B,OS0405-5,OS0405-4,OS0405-3,OS0405-2,OS0405-1,I3597B,I1907EU,I1907US,C2699R,C2699B,D5386B,D5386GR,D5386GY,D5386W,T2176-4,T2176-7,T2176-6,T2176-1,T2176-3,RM8786W-1,RM8786-3,RM8786W-4,PAE0039W,PAE0039R,PAE0039BL,PAE0039B,PA1425EU,D5312EU,D5312US,C5122BW,C5122C,C5122WB,C5122BL,C5122GR,C5122EN-BW,C5122EN-WB,C5122ES-BW,C5122ES-WB,C5122FR-BW,C5122FR-WB,T1314GR,T1314CA,T1126-1,PA4404B,PA4404R,PA4404S,PA4013RG-1,PA4013G-1,PA4013DGY-1,PA4013RG,PA4013G,PA4013DGY,D5210-7,D5210-5,D5210-3,D5210-1,D5210-6,D5210-4,D5210-2,D5024R,D5024BL,D5024B,D4660BR,D4660B,T541Y,PZ0118BL-EU,PZ0118B-EU,PZ0118S-EU,OS0334W,OS0334B,D5009-3,D5009-2,D5009-5,D5009-6,D5009-4,D5009-1,C1815B-RU,C1815B-AB,C1815B-HE,C1815B,C1815W,C1745B,RM9038-2,RM9038-1,PZ0095GY-EU,PZ0095G-EU,OS0890-S,OS0316EU,RM6931-2-R,RM6931-1-R,T2229-1,T2229-2,T2229-3,T2229-4,T2162-17,T2162-2,T2162-9,T2162-5,T2162-14,T2162-1,T2162-11,T2162-4,T2162-13,T2162-6,T2162-12,I3235-3,I3235-2,I3235-1,D1735B,D1735BR,C3149W-UK,C3149W-EU,C3149B-UK,C3149W-US,C3149B-US,C3149B-EU,T1384-6,T1384-3,T1384-4,T1384-5,T1384-2,RM299A,PZ0116R-EU,PZ0116CG-EU,PZ0116B-EU,PAA0189-1,PAA0189-2,OS0622BL-AU,OS0622BL-EU,OS0622Y-UK,OS0622P-UK,OS0622Y-EU,OS0622BL-US,OS0622P-EU,OS0622PU-AU,OS0622Y-AU,OS0622PU-UK,OS0622Y-US,OS0622PU-EU,OS0622P-US,OS0622BL-UK,OS0622PU-US,OS0622P-AU,I2568W,I2568G,I2568B,D5079C,D5079GR,D5079GY,D5079PU,D5079R,D4682-1,D4682-2,D4682-3,C5016W,C5016B,C1947R,T952-9,T952-8,T952-7,T952-6,T952-5,T952-4,T952-3,T952-2,T952-15,T952-14,T952-13,T952-12,T952-11,T952-10,T952-1,RM6534R,RM6534BL,I3013K,I3013GR,I3013B,T2168BL,T2168Y,T2168C,T2168GY,T2168R,T2168RO,T2168P,T2168W,T1219-3,T1219-2,T1219-1,T1179-1,T1179-3,T1179-2,I1416-3,I1416-2,I1416-5,I1416-1,T1401-10,T1401-3,T1401-1,T1401-9,T1401-8,T1401-7,T1401-4,T1401-5,T1401-6,PAA0127W,PAA0127B,OS0335W,OS0335B,I483B,I483W,I1984R,I1984BL,I1984G,D5089R,C5372B,C5372W,PW0006R,PW0006P,PW0006GR,PA4016R,PA4016BL,PA4016B,PA4016W,OS0483-2,OS0483-1,OS0444W,OS0444BU,OS0444BR,OS0444B,I48B,I48G,I48S,I3678DK,I3678G,I2605-2,I2605-1,D4481-9-L,D4481-8-L,D4481-7-L,D4481-9,D4481-8,D4481-7,D4481-6,D4481-5,D4481-4,D4481-3,D4481-2,D4481-10,D4481-1,RM8679-5,RM8679-2,RM8679-4,RM8679-6,RM8679-3,RM8679-1,PA3465S,PA3465BR,PA3465G,PA3465B,I2612S,I2612G,T2010-4,T2010-5,T2010-3,T2010-1,T2010-2,T1841-1,T1841-2,PZ0079BL-EU,PZ0079B-EU,PA4406B-1,PA4406B-2,PA4406B-3,PA4406B-4,PA4406B-5,PA4406B-6,PA4406W-1,PA4406W-2,PA4406W-3,PA4406W-4,PA4406W-5,PA4406W-6,I802B,I802S,C5370B,C5370BL,C5370R,C5370W,C5370Y,T1058-7,T1058-6,T1058-5,T1058-4,T1058-3,T1058-2,T1058-1,RM8937W,RM8937B-2,RM8937B,RM8937B-1,RM8937W-1,RM8937W-2,RM5093BL,RM5093R,PA4118P,PA4118R,PA4118G,PA4118RBL,PA4118B,F1604EU,F1604US,D5589B,D1785EU,D1785US,PAE0018-2,PAE0018-1,PAA0149R,PAA0149B,PAA0149BL,PAA0149S,I3626EU,I3626US,I2480-2,I2480-1,T2260-1,T2260-10,T2260-11,T2260-12,T2260-13,T2260-14,T2260-15,T2260-16,T2260-2,T2260-3,T2260-4,T2260-5,T2260-6,T2260-7,T2260-8,T2260-9,T2238-1,T2238-2,T1180-2,RM8261B,PAV0052DBL,PAS0073W,PA4154-BL,PA4154-B,PA4154-RO,PA4154-Y,PA3451B,PA3451G,I3684B,I3684G,I3684R,I3684S,C4117B,C4117BL,C2394LP,C2394LB,C2394GY,C2394B,C2394P,C2394DB,RM1533Y,RM1533BL,RM1533GR,PA4117TR,PA4117B,PA4308BL,PA4308P,PA4283B,PA4283BL,PA4283GR,PA4283P,PA4283R,PA4283W,OS0982-1,OS0982-2,OS0982-3,D5581B,D5581BL,D5581R,PZ0117W-EU-4,PZ0117B-EU-4,PA2559-2,PA2559-3,I1153PU,I1153P,I1153G,I1153BL,D4668B,T903W,T903R,T903GR,T891-3,T891-2,T891-1,T1375-5,T1375-9,T1375-19,T1375-4,T1375-7,T1375-8,T1375-6,T1375-3,T1375-21,T1375-20,T1375-2,T1375-17,T1375-14,T1375-18,T1375-16,T1375-15,T1375-13,T1375-12,T1375-11,T1375-10,T1375-1,RM8349G,RM8349B,OS0823BL,OS0823GR,OS0823R,OS0705B,OS0705W,I2988US,I2911US,I1835-2,RM9491R,RM9491Y,I2701-5,I2701-4,I2701-3,I2701-2,I2701-1,OS0291EU,PA3024B,PA3024G,C1437R,I2971-3,I2971-2,I2971-1,I3500G,I3500S,C5371B,C5371BL,RM9080GR,RM9080GY,RM9080Y,RM9080Y-1,RM9080GY-1,RM8130-1-C,RM8130-2-C,RM8130-2-BL,RM8130-1-BL,RM8130-2-B,RM8130-1-B,C3214K,C3214CA,T1440B,T1440R,T1440BL,C2550W,C2550B,OS0910B,OS0910R,OS0910W,OS0910BL,OS0910GR,T2259-1,T2259-10,T2259-11,T2259-12,T2259-2,T2259-3,T2259-4,T2259-5,T2259-6,T2259-7,T2259-8,T2259-9,D4814Y,D4814B,OS0406-2,OS0406-1,I2905-2,I2905-1,I1244W,I1244B,RM2504B,RM2504BL,PA4062W,PA4062B,I1983BL,I1983R,PA4214BL,PA4214P,PA4214PU,PA4214C,PA4214B,I3502G,I3502S,PA4347B,PA4347BL,PA4347GR,PA4347PU,PA4347R,RM9020-2,RM9020-1,T1312-4,T1312-3,T1312-2,T1312-1,V1753B,C2395LP,C2395LB,C2395GY,C2395DB,C2395B,RM3783R-UK,RM3783GR-UK,RM3783R-US,RM3783GR-US,OS0940-1B,OS0940-1S,OS0940-2B,OS0940-2S,D5528BL,D5528GR,D5528P,D5528SBL,D5528W,PA4325B,PA4325BL,PA4325PU,PA4325R,PA4325W,OS1051B,OS1051BE,OS1051BR,OS1051F,OS1051P,I3137EU,I3137US,I962Y,I962R,I962P,I962B,I962BL,P1628RO,P1628B,C3217K,C3217CA,T944S,T944PU,T944GR,T944G,T944BL,T944B,I2650W,I2650DR,I2650BL,T1386-3,T1386-4,RM10347GR-1,RM10347Y-1,RM10347GR,RM10347Y,D5618B,D5618BR,D5618K,PA4282B,PA4282BL,PA4282GR,PA4282P,PA4282R,PA4282W,D4791W-US,D4791B-US,C4221B-B,C2396GR,C2396DB,C2396B,OS0662-3,OS0662-2,OS0662-1,D5138B,D5138BL,D5138W,T2167-2,PA1632G,C1438BL,OS0290US,OS0290UK,OS0290EU,OS0290AU,C2969W,C2969GR,C2969R,C2969B,I3175-1,I3175-2,D5423GR,D5423R,D5423PU,I3141-4,I3141-3,I3141-2,I3141-1,D4708-7,D4708-6,D4708-4,D4708-2,D4708-1,D4708-3,OS0289US,OS0289UK,OS0289EU,OS0289AU,C2078S,C2078R,C2078PU,C2078BL,C2078G,C2078B,I2038W,I2038P,I2038B,I2038R,I2038GR,RM5703R,RM5703BL,RM5703GY,RM5703B,C5368B,C5368BL,C5368R,C5368RR,C5368S,I2791US,I2791UK,I2791EU,OS0156R,OS0156BL,RM2812Y,I1909US,I1909EU,T1842-1,T1842-2,T1842-3,T1842-4,OS0461-2,OS0461-1,I3029-3,I3029-2,I3029-1,D1277-2,PA2152P,PA2152BL,PA2152B,P1556UK,P1556US,P1556EU,I2000-2,I2000-1,I3204B-GR,I3204B-W,C4959R,C4959BL,C4959Y,C4959B,T2081-13,T2081-11,T2081-9,T2081-18,T2081-4,T2081-1,T2081-3,T2081-7,T2081-8,T2081-16,RM1534R,RM1534C,RM1534B,D5387B,D5387GR,D5387GY,D5387K,D5387W,D5387Y,D5387P,D5387R,I1273BL,I1273P,PA1444W,I1696G,I1696S,I1696GY,PA1450-6B,PA1450-2,PA1626BL,PA1626W,PA1626B,RM9535EU,RM9535-1,RM9355S,RM9355B,PA4255PU,PA4255Y,PA4255GR,PA4255BL,PA4255R,PA4255B,PA4255W,PAA0194-1,PAA0194-2,I3034-2,I3034-1,I1110-1,P1493W,T1409-5,T1409-4,T1409-3,T1409-2,T1409-16,T1409-15,T1409-13,T1409-12,T1409-11,T1409-10,T1409-1,T1409-20,T1409-21,I2606-2,I2606-1,D4035PU,D4035GR,D4035P,D4035BL,PA4135B,D5541-1,D5541-2,PAP0053-2,PAP0053-1,I3003W,I3003B,I2974BL,I2974B,OS0049GR,I2284W,I2284R,I2284DR,I2284BL,I2284B,I1850C,I1850B,I1168R,I1168PU,I1168BL,I1168B,I3319G,I3319R,I3319B,I59R,I59BL,I59Y,I59S,I59B,I3693B,I3693BL,I3693NA,I3693P,I3693R,D5388B,D5388GR,D5388W,PAA0222B-5,PAA0222B-6,PAA0222B-7,PAA0222B-8,PAA0222BB-5,PAA0222BB-6,PAA0222G-1,PAA0222G-2,PAA0222G-3,PAA0222G-4,PAA0222G-5,PAA0222G-6,PAA0222G-7,PAA0222G-8,PAA0222GY-1,PAA0222GY-2,PAA0222GY-3,PAA0222GY-4,PAA0222R-5,PAA0222R-6,PAA0222RG-1,PAA0222RG-2,PAA0222RG-3,PAA0222RG-4,PAA0222RG-5,PAA0222RG-6,PAA0222S-1,PAA0222S-2,PAA0222S-3,PAA0222S-4,PAA0222S-5,PAA0222S-6,PAA0222S-7,PAA0222S-8,I2993GY,I2993DBL,I2993BU,I2993BE,I2993B,D4755-3,D4755-5,D4755-4,D4755-2,D4755-1,D4754-5,D4754-4,D4754-3,D4754-2,D4754-1,T904W,T904P,T904GR,I2838US,I2838EU,OS0188RO,OS0188PU,OS0188P,OS0188BL,OS0188B,C2120W,C2120B,C2967S,C2967GY,C2967T,C2967R,C2967BL,T2050R,T2050PU,T2050Y,T2050BL,T2050GR,RM9412G,C4966W,D5352W,D5352B,PA4204-1,F858B,I453B,I3531-Z,I3531-ZD,I3531-ZM,T1215-2,T1215-1,T1215-4,T1215-3,RM8832US,RM8474R,RM8474B,I1914GY-EU,I1914BL-EU,I1914B-US,I1914B-EU,I1914BL,I1914GY,I2945-2,I2945-1,RM7981R,RM7981B,D3410Y,D3410BL,D3410W,D3410RO,D3410S,D3410G,T2057Y,T2057GR,T2057R,T2057C,I3283P,I3283BL,C5252R,C5252BL,T2192-2,T2192-1,PA4547B,PA4547BL,PA4547K,PA4547R,RM9188-2,RM9188-1,T1254-2,T1254-1,T1254-3,T1254-4,T1059-4,T1059-3,T1059-2,T1059-1,I2481-1,I2481-2,RM7737R,RM7737GR,RM7737BL,RM7559Y-US,RM7559Y-EU,RM7559R-US,RM7559R-EU,OS0287US,OS0287UK,OS0287EU,OS0287AU,RM7330R,RM7330GR,RM7330C,RM7330B,I2566S,I2566G,I2566B,PA2817B,PA2817W,C1435R,D5476BR,D5476MAGR,D5476MIGR,D5476P,D5476PU,D5476Y,I3627EU,I3627US,T2271MC-1,T2271MC-2,T2271Y-1,T2271Y-2,RM8915BR,I2706-2,I2706-1,I2477-3,I2477-2,I2477-1,I2323W,I2323B,I878-10,I878-8,D2369B,D2369BL,D2369S,D2369G,D2369RO,D2369W,D2369Y,D3758W,D3758Y,D3758BR,T2056R,T2056C,T2056Y,T2056GR,C4749EU,C4749UK,D5668B,D5668BL,D5668RO,D5668W,T2201-5,T2254B,T2254BE,T2254BL,T2254CA,T2254GY,T2254LGY,T2254LP,T2254MGR,T2254P,T2254PU,T2254R,T2254RO,T2254W,T2254Y,PAA0198B,PAA0198S,PA4115-1,PA4115-2,D4625R,D4625BL,D4625Y,D4625CM,PZ0065G-EU,PZ0065B-EU,T907R-4,T907R-3,T907R-2,T907R-1,T907BL-4,T907BL-3,T907BL-2,T907BL-1,RM7922GR,RM7922P,RM7922Y,RM7922BL,I2614Q,I2614G,I2458PU,I2458GR,I2458B,I815B,I2133R,I2133BL,I2133B,I2133P,I2133GR,I1819US,I2827-2,I2827-1,C4673UK,C4673EU,C4673AU,C4673US,I837-1P,I837-1B,I837-3,I837-1W,I837-5,I837-2,PAS0077W,RM9349W,RM9349B,PA1370B,RM10059BL,RM10059R,I3679B,I3679RG,I3679W,OS1134BL,OS1134BR,OS1134GR,OS1134P,OS1134PU,OS1134Y,D4991Y,T1214BL,T1214P,T1220-14,T1220-15,T1220-9,T1220-7,T1220-8,T1220-17,T1220-16,T1220-11,T1220-13,T1220-12,T1220-10,T1220-6,T1220-5,T1220-4,T1220-2,T1220-3,T1220-1,I2990US,RM8038R,RM8038B,T908R-4,T908R-3,T908R-2,T908R-1,T908BL-4,T908BL-3,T908BL-2,T908BL-1,T909R-4,T909R-3,T909R-2,T909R-1,T909BL-4,T909BL-3,T909BL-2,T909BL-1,I2802-4,I2802-3,I2802-2,I2802-1,PAE0017B,I2565S,I2565G,I2565B,OS0081US,OS0081UK,OS0081EU,C3474BL,C3474B,I1503B,I1503W,T906R-4,T906R-3,T906R-1,T906BL-4,T906BL-3,T906BL-2,T906BL-1,T906R-2,I1999-1,I1999-2,PA4185-2,PA4185-1,PA4243B-1,PA4243S-2,PA4243R-2,PA4243B-2,PA4243S-1,D3359B,D3359Y,D3359W,D3359RO,I1903C,I1903BL,C5396EU,C5396UK,C5396US,PA4319B,PA4319G,D5562B,D5562MC,T2258B,T2258GY,T2258LP,T2258MGR,T2258PU,T2258R,T2258RBL,T2258RO,T2258SB,T2258W,T2258WR,T2258Y,T1291P,T1291BL,T1291B,RM8779-2,RM8779-1,I3021-5,I3021-4,I3021-3,I3021-2,I3021-1,D4756-5,D4756-4,D4756-2,D4756-1,D4756-3,I2763-3,I2763-2,I2763-1,D4562S-US,D4562S-EU,D4562B-US,D4562B-EU,I2592US,I2592EU,I2456BE,I2456B,I2143UK,I2143AU,I2143EU,PA3391GY,PA3391S,PA3391G,I3324B,I3324W,I3324RO,T2016-2,T2016-1,I3666AE,I3666B,I3666G,I3666S,I3600EU,I3600US,PAA0137B,T1296-2,T1296-5,T1296-6,T1296-4,T1296-3,T1296-1,I3040-3,I3040-2,I3040-1,I3022W,I3022PU,I3022P,RM8063R-US,RM8063BL-US,RM8063R-EU,RM8063BL-EU,PAE0044R-RG,PAE0044R-B,PAE0044B-S,PAE0044B,I2805US,I2805UK,I2805EU,OS0322-2,OS0322-1,I2594S,I2594G,I2594B,I2335W,I2335B,P1453GY-US,P1453RG-US,P1453RG-EU,I1741-2,I1741-1,D1556BR,D1556B,RM9520G,RM9520S,RM9520W,I3322B,I3322RO,OS0831-1,OS0831-2,OS0831-3,D5474BL,D5474LBL,D5474P,D5474Y,F1734-1,F1734-10,F1734-2,F1734-3,F1734-4,F1734-5,F1734-6,F1734-7,F1734-8,F1734-9,D5675B,T1878BL-R,I3033-2,I3033-1,OS0471EU,I2940R,I2940DC,I2567G,I2567B,PZ0030Y-EU,PZ0030S-EU,PZ0030R-EU,PZ0030GR-EU,PZ0030G-EU,PZ0030B-EU,P1682BL,P1682B,I2441K,I2441B,I2162US,I2162EU,I2162UK,C2970GY,C2970R,C2970BL,T1405BR,T1405BL,I3317R,I3317G,OS0631P,OS0631GY,T1599-1,T1599-2,T1624-2,T1624-1,T1624-3,D3169B,D3169K,I3554NA,I3554R,I3554BL,D5475GR,D5475P,D5475R,D5475Y,C4848B,C4848W,PB0073B,PB0073RG,PB0073S,C59547B-EU,C5954B-UK,C5954B-US,OS0915-1,OS0915-2,T829-9,T829-8,T829-15,T829-12,T829-11,T829-14,T829-10,T829-13,T829-7,T829-3,T829-2,T829-1,T829-4,T829-6,T829-5,T1150Y-3,T1150BL-1,T1150R-2,C4262US,C4262UK,C4262EU,OS0541R,OS0541GR,OS0541B,OS0462-2,OS0462-1,I3109Y,I3109R,I3109P,I3109GR,I3109BL,T1060-7,T1060-6,T1060-5,T1060-4,T1060-3,T1060-2,T1060-1,I2935-4,I2935-3,I2935-2,I2935-1,I2625Y,I2625R,I2818S,I2818R,I2818G,I2818BL,OS0229US,OS0229UK,OS0229EU,OS0229AU,I2590US,I2590EU,I1739-2,I1739-1,C2708B,I1065B,I1065P,I1065BL,I1065W,I1065GR,I1065DB,I1065PU,I1065R,I1619-4,I1619-3,I1619-1,I1619-2,I1619-6,I1619-7,PA2281P,PA2281W,PA2281R,C2966R,C2966GR,C2966GY,OS0714B,OS0714BL,C4580DOWNB,C4580UPBL,C4580DOWNBL,C4580UPB,I3318G,I3318R,I3318B,I3267-1,I3267-2,I445S,I445BR,C1405B,I3568B,I3568BL,D5619B,D5619BR,D5619K,I3694BL,I3694GR,I3694NA,RM9213W,PA4307BL,PA4307P,PA4307Y,T2206-2,D5427-1,D5427-2,D5427-3,D5427-4,D5427-5,D5427-6,D5427-7,D5427-8,D5427-9,T1061-7,T1061-6,T1061-5,T1061-4,T1061-3,T1061-2,T1061-1,D4878B,I2939-3,I2939-2,I2939-1,T914Y,T914R,T914GR,T914BL,T911W,T911R,T911GR,T911BL,T911B,PB0006R,PB0006B,D4427-9,D4427-8,D4427-7,D4427-5,D4427-4,D4427-27,D4427-26,D4427-25,D4427-24,D4427-22,D4427-20,D4427-2,D4427-19,D4427-17,D4427-14,D4427-13,D4427-12,D4427-11,D4427-10,RM7320GY,RM7320G,RM7320BL,I2453BE,I2453B,PA2153-4,PA2153-5,PA2153-2,PA2153-9,PA2153-7,PA2153-3,PA2153-10,PA2153-8,PA2153-6,I2163EU,I2163UK,I576Y,I576PU,I576R,T1236-1,C4960BL,C4960B,C4960R,I3325-EQ,T1497-1,T1497-2,I3532-D,I3532-W,I3656S,I3656G,D5653-5,D5653-1,D5653-2,D5653-3,D5653-4,I3527-02,I3527-03,I3527-04,RM10357BL,RM10357R,D5551B,D5551W,RM9798B,RM9798R,I3753US,T2203-1,T2203-2,I3667G,I3667S,T1757-1,T1757-2,T2252B,T2252BE,T2252CA,T2252GY,T2252LP,T2252MGR,T2252P,T2252PU,T2252R,T2252RBL,T2252SB,T2252W,T2252WR,T2252Y,OS1087B,OS1087CY,OS1087MA,OS1087Y,RM8477EU,RM8477US,PAP0021W,PAP0021BL,PAP0021B,C4201W,C4201BL,C4201B,C4212-2,C4212-1,I3005B,I3005W,D4816K,D4816BR,D4816B,I2965BL,RM8120-2-W,RM8120-1-W,RM1121BL,I2694G,I2694W,I2694S,I2694P,I2694BL,I2694B,P1712C-EU,P1712B-EU,P1712Y-EU,P1712GR-EU,I2596S,I2596G,I2596B,OS0082US,OS0082UK,OS0082EU,I2485W,I2485R,I2485BL,PA3813W,PA3813B,C3170US,C3170UK,C3170EU,PA2359R,I2983EU,I1986BL,I1986G,I2039B,T2045GY,T2045BL,T2045B,T2045R,RM9331S-1,RM9331GR-2,RM9331GR-1,RM9331B-1,RM9331R-1,RM9331S-2,RM9331R-2,RM9331B-2,PA4149S,PA4149G,PA4149RG,RM9231GR,RM9231BL,RM9231BL-1,RM9231GR-1,PAA0145R,PAA0145BL,PAA0145S,D5372-3,D5372-2,D5372-1,PAA0130G,PAA0130B,PAA0130S,PA4250B,PA4250GY,OS0760R,OS0760B,OS0760BL,I938DB,I1871B,I1627EU,PA2862EU,PK0022B,PK0022R,PK0022G,PK0022S,C265GR,PA4310B,PA4310BL,PA4310GR,PA4310P,PA4310PU,PA4310W,I3672B,I3672BL,I3672C,T2241-1,T2241-2,T2241-3,C4380B,C4380W,I3124-1,I3124-2,T1295-4,T1295-5,T1295-6,T1295-3,T1295-1,T1295-2,I3075-3,I3075-4,I3075-2,I3075-1,PAV0017B,RM8513-3,RM8513-1,RM8513-2,OS0467-4,OS0467-3,OS0467-2,OS0467-1,RM8594US,RM8594-1-US,RM8594-2-US,D4686-3,D4686-2,D4686-1,C3542-W,I2739S,I2739G,I2739B,I2809-2,I2809-1,D4611-S,D4611-M,D4611-L,RM7854PU,RM7854GR,I2799-2,I2799-1,I924UK,I924EU,I924US,I2707-4,I2707-3,I2707-2,I2707-1,D4425W-UK,D4425B-UK,D4425W-US,D4425W-EU,D4425B-US,D4425B-EU,RM7124S,RM7124C,RM7124BL,RM7124B,C3198S,C3198R,I1571Y,I1571BL,I2092EU,I2092US,PA3397G,PA3397P,PA3397S,PA2919BL,PA2919RO,RM5663R,RM5663B,RM5663GY,T1468-1,P1605W,P1605B,C5113EU,C5113US,C5240-1,OS0828-3,OS0828-1,OS0828-2,F1261R,I1609W,I1609B,I1609BU,I1609R,C4381B,C4381W,C4383BR,C4383B,I3528-11Z,I3528-11ZD,I3528-12Z,I3528-12ZD,I3528-13Z,I3528-13ZD,D5674BL,D5674P,D5674S,D5674W,D5674B,I3643BL,I3643R,D5529LGR,D5529P,PA4254W,PA4254PU,PA4254BL,PA4254GR,PA4254B,T2243BL,T2243C,T2243GR,T2243P,T2243Y,T2264B,T2264BU,T2264CA,T2264GR,T2264P,T2264PU,T2264R,T2264RBL,T2264SB,T2264W,T2264WR,T2264Y,D5470-1,D5470-2,D5470-3,D5470-4,D5470-5,D5470-6,D5470-7,D5470-8,D5471-1,D5471-2,D5471-3,D5471-4,D5471-5,D5471-6,D5471-7,D5472-1,D5472-2,D5472-3,D5472-4,D5472-5,D5472-6,D5472-7,OS1062BE,OS1062BR,OS1062F,OS1062P,C4345US,C4345UK,C4345EU,C4345AU,C4292US,C4292UK,C4292EU,C4292AU,PA4029S,PA4029BL,PB0008PU,PB0008P,PB0008GR,PB0008BL,PB0008B,I2792US,I2792UK,I2792EU,I2728-2,I2728-1,D1098-2,PA3948W,PA3948PU,PA3948GR,PA3948BL,PA3948B,RM7209W,RM7209G,C3604S-13,C3604P-15,C3604GR-15,C3604G-13,C3604B-13,D4294-1,P1379S-EU,P1379B-EU,I1108-4,I1108-3,I1108-2,I1108-1,I1436S,PA3408B,PA3408CH,PA3408S,PA3408RG,PA3399S,PA3399G,PA3399P,I1760NA,T2038-2,T2038-1,PB0056Y,PB0056R,PB0056B,PA4146-3,PA4146-2,PA4146-10,PA4146-1,PA4146-8,PA4146-4,PA4146-9,PK0023G,PK0023S,PK0023B,T2002-2,T2002-3,T2002-1,T2159-5,T2159-1,T2159-2,PA4231R,PA4231GY,PA4231B,PA4231BL,PA4231W,PA4230P,PA4230BL,PA4230B,PA4198B,PA4198ROG,PA4198S,OS0786-2,C4768UK,C4768US,C4764EU,C4764UK,C4599EU,C4599UK,I3179-2,I3179-1,F1659R,F1659PU,F1659GR,F1659W,F1659BL,RM9843C,RM9843GR,I3687B,I3687BL,I3687P,I3687W,D5654-5,D5654-1,D5654-2,D5654-3,D5654-4,D5832B,D5832R,D5832S,F1697B,F1697BL,F1697R,F1697TR,F1729B,F1729W,OS0909-1,OS0909-2,OS0909-3,OS0909-4,OS0909-5,OS0909-6,I3719BL,I3719BR,I3719R,I3719Y,PA4285B,PA4285W,I3671B,I3671NA,I3671R,I3671W,F1694B,F1694W,T1859-1,T1859-2,T1859-3,T1859-4,T1859-5,T1859-6,F1736-1,F1736-10,F1736-2,F1736-3,F1736-4,F1736-5,F1736-6,F1736-7,F1736-8,F1736-9,PA4312GR,PA4312R-W,PA4312S,OS0930BL,OS0930GR,OS0930P,OS0930PU,PAI0044B,RM10144US,D5376-2,D5376-1,T1758BL,T1758P,T2267B,T2267W,C4389GY,C4389W,C4389B,PAA0197G,PAA0197RG,PAA0197S,OS1054B,OS1054BE,OS1054BR,OS1054F,OS1054W,OS1066P,OS1066R,OS1066GR,OS1066W,OS1060BE,OS1060BR,OS1060F,OS1060P,PB0049G,PB0049B,I3136US,I3136EU,OS0540B,OS0540P,OS0540BL,T1091-2,T1091-1,OS0478-2,OS0478-1,PAS0041US,PAS0041EU,T1056-6,T1056-5,T1056-4,T1056-3,T1056-2,T1056-1,PAA0030W,PAA0030B,OS0458BL,OS0458B,I2986W,I2986B,OS0419LGR,OS0419BR,OS0419BL,OS0419B,RM8027US,RM8027EU,OS0381W,OS0381B,RM7858W,RM7858B,PAE0020W,PAE0020S,PAE0020G,PAE0020B,D4563S-US,D4563S-EU,D4563B-US,D4563B-EU,PA3999S,PA3999G,PA3999B,RM7323Y,RM7323R,OS0048GR,C3353S,C3281W,C3281R,C3281PU,C3281P,C3281GR,C3281BL,C3281B,C3216K,C3216CA,PA2792-10,PA2792-07,PA2792-05,PA2792-03,PA2792-01,C2423B,I1035R,C2204LP,C2204LB,C2204GY,C2204R,C2204P,C2204GR,C2204BL,C2204B,I1529S,PA2236BL,PA2236RO,PA2236R,PA2236W,PA2025-8,PA2025-7,PA2025-1,PA2025-3,PA2025-4,PA2025-9,PA2025-2,PA2025-6,PA2025-5,PA2025-10,PA2028W,PA2028BL,PA2028RO,PA2028R,PA1823S,I3327GR,I3327W,D5142G,RM8894BL,RM8894B,RM8893BL,RM8893B,T1315R-2,T1315R-1,T1315GR-2,T1315BL-2,T1315BL-1,C4962-3,C4962-1,C4962-5,C4962-2,RM9643R,RM9643B,PA4244G,PA4244B,PB0062B,PB0062BL,PB0062R,PB0062P,PAB0003-1,PAB0003-2,T2068BL,T2068Y,T2068R,PA4232GY,PA4232GR,PA4232C,PA4232BL,RM9503BL,C4233EU,C4233UK,C4233AU,T210Y-US,T210GY-EU,T210BL-UK,T210Y-EU,PA1437BEU,PA1437WAU,PA1437BUK,PA1437BAU,PA1437WUK,PA1108EU,C4378W,C4378R,C4378GY,C4378DR,C4378BL,C4378B,C4649B,C4649S,C4655-1,C4655-2,F1648W,I3594-1,I3594-2,D5652-1,D5652-2,D5652-3,D5652-4,D5652-5,I3759P,I3759R,I3759Y,F1726B,F1726BL,F1752B,F1752BL,F1752R,F1752W,D5659-1,D5659-2,D5658-1,D5658-2,F1677EU,F1677US,I3680-14,I3680-8,T1239-1,T1239-2,T1239-3,OS0808BL,T2208-1,T2208-2,T2205-1,T2205-2,PAA0133B,PAA0135B,T2242-1,T2242-2,C4392B,C4392W,C4394B,C4394W,PA4315G,PA4315GY,PA4315RG,PA4315S,PA4090Y,PA4090R,PA4090G,OS0481-9,OS0481-8,OS0481-7,OS0481-6,OS0481-5,OS0481-4,OS0481-3,OS0481-21,OS0481-20,OS0481-2,OS0481-19,OS0481-18,OS0481-17,OS0481-16,OS0481-15,OS0481-14,OS0481-13,OS0481-12,OS0481-11,OS0481-10,OS0481-1,PB0034R,PB0034GR,D4913-2,D4913-1,C4289US,C4289UK,C4289EU,C4289AU,T1125-1,T1063-2,T1063-1,D4853-3,D4853-2,D4853-1,PA4044S,PA4044B,I3006R,I3006NA,I2702-4,I2702-3,I2702-2,I2702-1,D4713-1,PG0003W,PG0003B,OS0407-5,OS0407-4,OS0407-3,OS0407-2,OS0407-1,PA3992W,PA3992B,PA3991W,PA3991B,RM7192R-US,RM7192R-EU,RM7192GR-US,RM7192GR-EU,I2446-2,I2446-1,C3171US,C3171UK,C3171EU,I1883US,I1883UK,PA3135W,PA3135P,PA3135B,C2229Y,C2229R,C2229P,C2229GY,C2229DB,C2229BL,C2229B,C2229C,PA2235G,PA2235B,PA2235RO,PA2234R,PA2234RO,PA2234P,PA2279S,PA2279G,PA2279RO,PA2279B,PA2029RO,PA2029W,PA2029R,PA2029BL,RM5723EU,RM5723US,D3898P,D3898B,D3898W,PA1594BL,PA1594RO,PA1594W,PA1594PU,D5172B,I3458-2,I3458-1,I3473B,T1608-3,T1608-6,T1608-7,T1608-5,T1608-1,T1608-8,T1608-9,PA4197ROG,PA4197S,C5141G,C5141BL,RM5077US,RM5077-4-US,RM5077-3-US,RM5077-1-US,RM5077-2-US,T1829US,D5660-1,D5660-2,I3501G,I3501S,C4847B,C4847W,RM10226B,RM10226W,PA4327B-BL,PA4327B-GR,PA4327BL,PA4327B-R,PA4327GR,T1557-3,T1557-2,T2204-1,T2204-2,PAI0047W,D5563B,D5563W,C5915BL,C5507B,OS0984B,OS0984W,OS1058B,OS1058BE,OS1058BR,OS1058P,OS1072B,OS1072BR,OS1072F,OS1072P,OS1072W,OS1072Y,T843-5,T843-2,T843-4,T843-3,T843-1,PAE0051BG,PAE0051WS,PAE0051WG,PAE0051BS,D4948-4,D4948-3,D4948-2,D4948-5,D4948-1,PA4072W,PA4072S,PA4072R,PA4072CO,PA4072BL,PA4072B,PAA0036W-AU,PAA0036B-AU,RM8473R,RM8473B,PA4042Y-4,PA4042Y-3,PA4042Y-2,PA4042Y-1,PA4042W-4,PA4042W-3,PA4042W-2,PA4042W-1,PA4042T-4,PA4042T-3,PA4042T-2,PA4042T-1,PA4042RO-4,PA4042RO-3,PA4042RO-2,PA4042RO-1,PA4042RBL-4,PA4042RBL-3,PA4042RBL-2,PA4042RBL-1,PA4042RB-4,PA4042RB-3,PA4042RB-2,PA4042RB-1,PA4042PW-4,PA4042PW-3,PA4042PW-2,PA4042PW-1,PA4042P-4,PA4042P-3,PA4042P-2,PA4042P-1,PA4042LBL-4,PA4042LBL-3,PA4042LBL-2,PA4042LBL-1,PA4042GY-4,PA4042GY-3,PA4042GY-2,PA4042GY-1,PA4042DB-4,PA4042DB-3,PA4042DB-2,PA4042DB-1,PA4042BLW-3,PA4042BLW-2,PA4042BLW-1,PA4042BLW-4,PA4042BL-4,PA4042BL-3,PA4042BL-1,PA4042B-4,PA4042B-3,PA4042B-2,PA4042B-1,I2994GY,I2994DBL,I2994BU,I2994BE,I2994B,RM8404W,RM8404B,PAE0048S,PAE0048BL,PAE0048B,T946WB,T946RB,T946R,T946B,RM6562Y-EU,PAE0028R,PAE0028BL,PAP0007W,PAP0007R,PAP0007G,PAP0007B,D4426-12,D4426-11,D4426-10,D4426-14,D4426-13,D4426-9,D4426-5,D4426-2,D4426-19,D4426-18,D4426-17,D4426-20,D4426-4,D4426-3,D4426-28,D4426-26,D4426-25,D4426-24,D4426-21,OS0196US,OS0196UK,OS0196EU,OS0196AU,OS0192W,OS0192B,OS0193W,OS0193B,RM7423W,RM7423B,I2242US,I2242UK,I2242EU,C3168US,C3168UK,C3168EU,RM6568EU,C4579EU,C4579US,T1362-5,T1362-4,T1362-3,T1362-2,T1362-6,T1362-7,T1362-1,T1232-3,T1232-1,T1232-2,PAP0126BL,PAP0126W,PAP0126B,I3180-1,I3180-2,T1697-5,T1697-2,T1697-3,T1697-4,PAA0151P,PAA0151PU,PAA0151BL,PAA0151GR,I3221W,C5201-1,C5201-2,OS0762R,OS0762BL,OS0762B,RM9371-1,RM9371-2,RM9371-3,RM9371-4,PA1853B,C4384B,C4384R,C4384BL,D5356B,D5356BL,D5356R,RM9519G,RM9519W,RM9519S,RM9519S-1,RM9519G-1,RM9519W-1,D5553B,D5553W,I3723-1,I3723-2,I3723-3,D5620B,D5620BR,D5620K,RM9728B,T1848-1,T1848-2,T1848-3,F1755-1,F1755-2,C5290-1,C5290-2,C5290-3,C5290-5,PB0072GY,PB0072R,PB0072BL,PW0015BL,PW0015P,PAA0136B,I3654-1,I3654-2,T2244BL,T2244R,T2244Y,C5916B,C5914BL,PAF0004B,PAF0004RG,PAF0004G,PAF0004S,OS1053B,OS1053BE,OS1053BR,OS1053F,OS1056-2BR,OS1056B,OS1056BE,OS1078GR,OS1078W");
		$array_sn = array_chunk($goods,50);
		//print_r($array_sn);die;
		foreach($array_sn as $sn){
			$data_goods = implode(",",$sn);
			$data['spus'] = explode(",",$data_goods);
			$data['warehouse'] = 'CN';
			$res = $this->getCurlData($url,'post',$data);
			$response = json_decode($res);
			$this->model_quark_quark->insertProductListUpdate($response); 
		}
	}
	
	public function GetProductStock()
	{
		$this->load->model('quark/quark');
		$goods = $this->model_quark_quark->getProductSku();
		$token = $this->GetAccessToken();
		$url = 'http://dpapi.quarkscm.com/v1/myproduct/multi-get';
		$data['access-token'] = $token;
		
		$i=0;
		$goodsSN = array();
		foreach($goods as $key=>$goods)
		{	
			$goodsSN[$i] = $goods['sku'];
			$i++;
		}
		$array_sn = array_chunk($goodsSN,100);
		
		foreach($array_sn as $sn){
			if($sn == 'H21697')
{

}
else
{
			$data_goods = implode(",",$sn);
			$data['skus'] = explode(",",$data_goods);
			$data['warehouse_name'] = "CN";
			$res = $this->getCurlData($url,'post',$data);
			$response = json_decode($res);
			$this->model_quark_quark->updateProductStock($response);
		} 
}
	} 
	
	function getCurlData($url,$type="get",$data=array(),$timeout = 10) {
		$http_header = array();
		if(isset($data['access-token'])){
			$http_header[] = 'access-token: ' . $data['access-token'];
			unset($data['access-token']);
		}
		$url = str_replace(' ','+',$url);
		if (strtolower($type) == "get") {
			if (!empty($data) && is_array($data)) {
				$arr = [];
				foreach ($data as $k=>$v) {
					$arr[] = $k."=".$v;
				}
				$str = implode("&",$arr);
				if (strstr($url,"?")) {
					$url .= "&".$str;
				} else {
					$url .= "?".$str;
				}
			}
		}
		
		$ch   = curl_init();
		curl_setopt($ch, CURLOPT_URL, "$url");
		curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
		curl_setopt($ch,CURLOPT_TIMEOUT,$timeout);  //定义超时3秒钟
		if(strtolower($type) == "post"){
			$data = json_encode($data);
			curl_setopt($ch, CURLOPT_POST, 1);
			$http_header[] = 'Accept: application/json';
			$http_header[] = 'Content-Type: application/json';
			$http_header[] = 'Content-Length: ' . strlen($data);

			// 
			curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
		}
		curl_setopt($ch, CURLOPT_HTTPHEADER,$http_header);
		$output = curl_exec($ch);
		curl_close($ch);
		return $output;
	}	
	
	function getCurlDataToken($url,$type="get",$data=array(),$timeout = 10) {
		$url = str_replace(' ','+',$url);
		if ($type == "get") {
			if (!empty($data) && is_array($data)) {
				$arr = [];
				foreach ($data as $k=>$v) {
					$arr[] = $k."=".urlencode($v);
				}
				$str = implode("&",$arr);
				if (strstr($url,"?")) {
					$url .= "&".$str;
				} else {
					$url .= "?".$str;
				}
			}
		}
		
		$data = json_encode($data);
		$ch   = curl_init();
		curl_setopt($ch, CURLOPT_URL, "$url");
		curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
		curl_setopt($ch,CURLOPT_TIMEOUT,$timeout);
		if($type == "post"){
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, 
				CURLOPT_HTTPHEADER, 
				[
					'Accept: application/json',
					'Content-Type: application/json',
					'Content-Length: ' . strlen($data)
				]
			);
			curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
		}
		$output = curl_exec($ch);
		curl_close($ch);
	return $output;
	}
	
	public function ProcessOrder()
	{
		$this->load->model('quark/quark');
		$orders = $this->model_quark_quark->getOrders();
		//echo '<pre>';
		//print_r($orders);die; 
		
		$token = $this->GetAccessToken();
		$api_url = 'http://dpapi.quarkscm.com/v1/myorder/import';
		//echo "<pre>";print_r($orders);echo "</pre>-----";die;
		foreach($orders as $sn){
			//echo $sn['temp_id'];die;
			$sku = substr($sn['model'],3);
			$amount = $this->model_quark_quark->getOrdersAmount($sn['order_id']);
			$goods_info = $this->model_quark_quark->getGoodsInfo($sn['order_id']);
			$post_data = [
				'access-token' => $token,
				'orderInfos' => [
					[
						'orginal_order_no'          => $sn['temp_id'],           // 原始订单号
						'customer_firstname'        => '承勇',        // 客户的first name
						'customer_lastname'         => '罗',         // 客户的last name
						'customer_telephone'        => '13410153396',         // 客户的电话
						'customer_email'            => 'shaifali1j@gmail.com',             // 客户的email
						'customer_address_country'  => 'CN',   // 客户的国家简码，譬如CN,US,
						'customer_address_state'    => '广东省',     // 客户收货地址的省/州
						'customer_address_city'     => '深圳市',      // 客户收货地址的城市
						'customer_address_zip'      => '518001',       // 客户收货地址的邮政编码
						'customer_address_street1'  => '深南東路3020號百貨廣場東座2603室',   // 客户收货地址的详细地址1
						'customer_address_street2'  => '深圳市羅湖區',   // 客户收货地址的详细地址2
						'remark'                    => 'ship', //备注
						'origin_order_platforms'    => 'amazon',     // 原始订单所在的平台 ,ebay,amazon,aliexpress,wish,lazada,other
						'origin_amount'             => $amount,              // 原始订单的金额（美元）
						'shipping_method'           => 'YD2',         //货运方式
						'products' => [
							[
								'sku' =>$sku,
								'warehouse' =>'CN',
								'qty' => 1
							]  
						],
					],
				]
			];
			$return_data = $this->getCurlDataProcessOrder($api_url,'post',$post_data,10);
			$this->model_quark_quark->updateOrder($return_data,$sn['temp_id'],$sn['order_id']);
			
		}
	}
	
	function getCurlDataProcessOrder($url,$type="get",$data=array(),$timeout = 10) {
		//对空格进行转义
		$url = str_replace(' ','+',$url);
		if ($type == "get") {
			if (!empty($data) && is_array($data)) {
				$arr = [];
				foreach ($data as $k=>$v) {
					$arr[] = $k."=".$v;
				}
				$str = implode("&",$arr);
				if (strstr($url,"?")) {
					$url .= "&".$str;
				} else {
					$url .= "?".$str;
				}
			}
		}
		$access_token = '';
		if(isset($data['access-token'])){
			$access_token = $data['access-token'];
			unset($data['access-token']);
		}
		
		$data = json_encode($data);
		$ch   = curl_init();
		//设置选项，包括URL
		
		curl_setopt($ch, CURLOPT_URL, "$url");
		curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
		curl_setopt($ch,CURLOPT_TIMEOUT,$timeout);  //定义超时3秒钟  
		if($type == "post"){
			// POST数据
			curl_setopt($ch, CURLOPT_POST, 1);
			$http_header = [
				'Accept: application/json',
				'Content-Type: application/json',
				'Content-Length: ' . strlen($data),
			];
			if($access_token){
				$http_header[] = 'access-token: ' . $access_token;
			}
			curl_setopt($ch, CURLOPT_HTTPHEADER,$http_header);
			// 把post的变量加上
			curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
		}
		//执行并获取url地址的内容
		$output = curl_exec($ch);
		//echo $output ;
		//释放curl句柄
		curl_close($ch);
		//var_dump($output);exit;
		
		return $output;
	}
	
	 public function OrderImport()
	{
		$this->load->model('quark/quark');
		$orders = $this->model_quark_quark->getSupplireOrders();
		$token = $this->GetAccessToken();
		$url = 'http://dpapi.quarkscm.com/v1/myorder/get-shipping-tracking-number';
		foreach($orders as $sn){
			$data['access-token'] = $token;
			$data['orginal_order_no'] = $sn['wms_order_id'];
			$return_data = $this->getCurlData($url,'post',$data);
			$response = json_decode($return_data);
			$this->model_quark_quark->insertSupplireOrderImport($response,$sn['supplire_order_id'],$sn['wms_order_id']);
		}
	}
}
